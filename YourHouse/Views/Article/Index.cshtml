@model List<YourHouse.Models.Entities.Article>;
@using System.Text.Json

@{
    ViewData["Title"] = "Bài đăng";
    var citys = ViewData["City"] as List<YourHouse.Models.Entities.City>;
    var districts = ViewData["District"] as List<YourHouse.Models.Entities.District>;
}

<div class="container">
    <div class="row">
        <div class="col-2">
            <div class="row">
                <div class="accordion" >
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                Danh mục
                            </button>
                        </h2>
                    </div>
                </div>
                <div class="form-check d-flex align-items-center">
                    <input class="form-check-input" type="radio" name="TypeArticle" id="All">
                    <label class="form-check-label d-block flex-grow-1 pt-2 pb-2 ms-2" for="All">
                        Tất cả
                    </label>
                </div>
                <hr class="mt-0 mb-0" />
                <div class="form-check d-flex align-items-center">
                    <input class="form-check-input" type="radio" name="TypeArticle" id="Tro">
                    <label class="form-check-label d-block flex-grow-1 pt-2 pb-2 ms-2" for="Tro">
                        Trọ
                    </label>
                </div>
                <hr class="mt-0 mb-0" />
                <div class="form-check d-flex align-items-center">
                    <input class="form-check-input" type="radio" name="TypeArticle" id="House" checked>
                    <label class="form-check-label d-block flex-grow-1 pt-2 pb-2 ms-2" for="House">
                        Nhà
                    </label>
                </div>
                <hr class="mt-0 mb-0" />
                <div class="form-check d-flex align-items-center">
                    <input class="form-check-input" type="radio" name="TypeArticle" id="ChungCu" checked>
                    <label class="form-check-label d-block flex-grow-1 pt-2 pb-2 ms-2" for="ChungCu">
                        Căn hộ/Chung Cư
                    </label>
                </div>
                <hr class="mt-0 mb-0" />
                <div class="form-check d-flex align-items-center">
                    <input class="form-check-input" type="radio" name="TypeArticle" id="Office" checked>
                    <label class="form-check-label d-block flex-grow-1 pt-2 pb-2 ms-2" for="Office">
                        Văn Phòng
                    </label>
                </div>
            </div>
            <div class="row">
                <div class="accordion" >
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                Địa chỉ
                            </button>
                        </h2>
                    </div>
                </div>
                <label class="mt-3">Tỉnh/Thành phố</label>
                <select class="form-select mt-2 select_city">
                    <option value="-1">Tất cả</option>
                    @foreach(var item in citys)
                    {
                        <option value="@item.CityId">@item.CityName</option>
                    }
                </select>

                <label class="mt-3">Quận - Huyện</label>
                <select class="form-select mt-1 select_district">
                </select>
            </div>
            <div class="row mt-3">
                <div class="accordion" >
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                Giá - vnđ
                            </button>
                        </h2>
                    </div>
                </div>
                <div class="input-group mt-3">
                    <input type="number" min="0.0" step="0.01" class="form-control" placeholder="Min" aria-label="Username" />
                    <span class="input-group-text">-></span>
                    <input type="number" min="0.0" step="0.01" class="form-control" placeholder="Max" aria-label="Server" />
                </div>
                <div class="input-group mt-2">
                    <button class="ms-auto btn btn-outline-primary">Lọc</button>
                </div>
            </div>
        </div>

        <div class="col-10">
            @{
                var articleLength = Model.Count();
            }
            @for (int i = articleLength - 1; i >= 0; i--)
            {
                <a href="#" class="text-dark nav-link">
                    <div class="card mb-3 d-flex" style="min-width: 863px;">
                        <div class="row">
                            <div class="col d-flex">
                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSq8aVvwt226C1Kx4QqQzL5IibUHcRbb1XCtw&s" class="img-fluid rounded-start" alt="...">
                                <div class="card-body">
                                    <h5 class="card-title">@Model[i].Title</h5>
                                    <p class="card-text">@Model[i].DescAr</p>
                                    <p class="card-text"><small class="text-body-secondary">@Model[i].Price</small></p>
                                    <p class="card-text"><small class="text-body-secondary">@Model[i].CreateAt vnđ</small></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
            }
        </div>
    </div>
</div>

<script>
     const selectCityElement = document.querySelector('.select_city');
     let districts = @Html.Raw(JsonSerializer.Serialize(districts));

    function selectCity() {
            const value = selectCityElement.value;
            let html = `<option value="-1">Tất cả</option>`;;
            districts.forEach(district => {
                if(district.CityId == value) {
                    html += `<option value="${district.DistrictId}">${district.DistrictName}</option>`;
                }
            });
            document.querySelector('.select_district').innerHTML = html;
        }

    selectCity();

    selectCityElement.onchange = () => {
        selectCity();
    }
</script>
